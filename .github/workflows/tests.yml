name: Test functions

on:
    workflow_dispatch:
    push:
        branches: [official_stats]
        paths:
            - 'cloud_functions/**'

jobs:
    test_official_stats:
        runs-on: ubuntu-latest
        steps:
            - name: 'Checkout'
              uses: 'actions/checkout@v3'

            - name: Set up Python
              uses: actions/setup-python@v4
              with:
                python-version: '3.8'
            
            - name: Install dependencies
              run: |
                python -m pip install --upgrade pip
                pip install -r cloud_functions/official_stats/requirements.txt

            - name: Linting
              run: pylint cloud_functions/.
            
            - name: unittests
              run : pytest